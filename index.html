<html lang="en">

<head>
  <meta charset="utf-8" />

  <title>IOT Data</title>
  <style>
    body {
      background-image: url("Image.jpg");
    }

    .button {
      background-color: #4CAF50;
      border: none;
      color: white;
      padding: 20px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
    }
    .button4 {
      border-radius: 12px;
    }
  </style>
</head>

<body>
  <h1 style="color:GREEN;">On-Premise IOT Data Channel</h1> <button class="button button4" onclick="clearlog()">Clear Logs</button>

  <!-- <input style="width: 800px;height: 200px" type="text" placeholder="enter text here to send to server" id="eingabe" onkeypress="myFunction(event)"/> -->
  
  <div style="overflow:scroll; width: 300px; height: 550px; border: solid; border-radius: 9px" id="display"></div>

  <script>
    //var sock =new WebSocket("ws://localhost:5001");
    var sock = new WebSocket('ws://192.168.1.6:3001');  //replace this address with the one the node.js server prints out. keep port 3000
    var display = document.getElementById("display")

    sock.onopen = function (event) {
      //alert("Socket connected succesfully!!!")
      setTimeout(function () { sock.send('Connection Succeeded'); }, 1000);
      display.innerHTML += "Connection Succeeded <br />";

    };
    sock.onmessage = function (event) {
      console.log(event);//show received from server data in console of browser
      display.innerHTML += event.data + "<br />"; //add incoming message from server to the log screen previous string + new string(message)

    }

    function myFunction(event) {
      //sock.send("Hello");
      if (event.keyCode == 13) {	   //when enter is pressed...
        var text = document.getElementById('eingabe').value;    //assign value of the entered string to te text variable
        if (text != "") {     //if text is not an empty string
          //display.innerHTML+="From Client: "+text+"<br />"; //show the message from client in div
          sock.send(text);    //send string to server
          display.innerHTML += "<strong>Me: </strong>" + text + "<br />";       //display input text in div (client side)
          document.getElementById('eingabe').value = "";     //and clear the input field
        }
        else {
          console.log("empty string not sent")
        }
      }
    }

    function clearlog() {
      display.innerHTML = "";
    }
  </script>
</body>

</html>